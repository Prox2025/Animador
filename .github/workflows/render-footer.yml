name: Remover fundo do vídeo automático

on:
  workflow_dispatch:

jobs:
  download_and_remove_background:
    runs-on: ubuntu-latest

    steps:
    - name: 📥 Clonar repositório
      uses: actions/checkout@v4

    - name: 🔧 Configurar Node.js
      uses: actions/setup-node@v3
      with:
        node-version: '18'

    - name: 🚀 Instalar dependências Node.js
      run: npm install puppeteer

    - name: 🛠️ Instalar FFmpeg e Python OpenCV
      run: |
        sudo apt update
        sudo apt install -y ffmpeg python3 python3-pip
        pip3 install opencv-python numpy

    - name: 📥 Baixar vídeo via Puppeteer
      run: node baixar_video.js

    - name: 🐍 Remover fundo do vídeo (Python)
      run: python3 remover_fundo.py

    - name: 📤 Publicar artefato (vídeo final)
      uses: actions/upload-artifact@v4
      with:
        name: video_fundo_removido
        path: videos/video_fundo_removido.webm
