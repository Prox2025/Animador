name: Processar VÃ­deo com TransparÃªncia

on:
  workflow_dispatch:

jobs:
  video_pipeline:
    runs-on: ubuntu-latest

    steps:
      - name: ğŸ“ Checkout do repositÃ³rio
        uses: actions/checkout@v3

      - name: ğŸ§± Instalar Node.js e Puppeteer
        run: |
          sudo apt update
          sudo apt install -y nodejs npm
          npm install puppeteer

      - name: ğŸ§ª Instalar Python, FFmpeg e Pillow
        run: |
          sudo apt install -y ffmpeg python3-pip
          pip install numpy pillow

      - name: ğŸŒ Baixar vÃ­deo com Puppeteer + https.get
        run: node baixar_com_puppeteer.js

      - name: ğŸ” Verificar vÃ­deo baixado
        run: ls -lh videos/entrada.mp4

      - name: ğŸ¨ Remover fundo e gerar vÃ­deos transparentes
        run: python3 remover_fundo.py

      - name: ğŸ“¤ Upload do MP4 com alpha (ProRes 4444)
        uses: actions/upload-artifact@v4
        with:
          name: video-alpha-prores-mp4
          path: saida/video_sem_fundo.mp4

      - name: ğŸ“¤ Upload do WebM com alpha
        uses: actions/upload-artifact@v4
        with:
          name: video-alpha-webm
          path: saida/video_sem_fundo.webm
